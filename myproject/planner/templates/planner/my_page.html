{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>마이페이지 - 여행 플래너</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{% static 'css/my_page.css' %}" rel="stylesheet">
  <!-- ↑ 위 링크는 Django static 연결 예시입니다. 상황에 맞게 수정하세요. -->
</head>
<body>
<div class="container mt-5">
  <!-- 상단 로고, 제목 등 -->
  <h2>마이페이지</h2>

  <!-- 메인 레이아웃(row) 잡기 -->
  <div class="row">
    <!-- 왼쪽 사이드 메뉴 -->
    <div class="col-3 side-nav">
      <h4 class="side-nav-title">내 정보</h4>
      <ul class="list-unstyled">
        <li><a href="#basic-info" class="active" onclick="showSection('basic-info'); return false;">기본 정보</a></li>
        <li><a href="#update" onclick="showSection('update'); return false;">회원 정보 수정</a></li>
        <li><a href="#delete" onclick="showSection('leave'); return false;">회원탈퇴</a></li>
      </ul>
    </div>
    
    <!-- 오른쪽 본문 영역 -->
    <div class="col-9 main-content">
      <!-- 예: 회원 정보 섹션 -->
      <section id="basic-info">
        <h3>기본 정보</h3>
        <p>이메일: {{ user.email }}</p>
        <p>이름: {{ user.name }}</p>
        <p>생년월일: {{ user.birth }}</p>
        <p>주소: {{ user.addr }}</p>
        <p>전화번호: {{ user.phone_num }}</p>
      </section>

      <!-- 회원 정보 수정 섹션 (AJAX로 업데이트 폼 로드) -->
      <section id="update" style="display: none;">
        <div id="updateProfileContainer">
          <!-- update_profile.html(또는 부분 템플릿)의 내용이 여기 로드됩니다 -->
        </div>
      </section>

      <!-- 회원탈퇴 섹션 (예시) -->
      <section id="delete" style="display: none;">

      </section>

      <br>
      <a href="{% url 'main_page' %}" class="btn btn-secondary">홈으로</a>
    </div>
  </div><!-- /.row -->
</div><!-- /.container -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
function showSection(sectionId, event) {
    // 모든 섹션 숨기기
    document.querySelectorAll('.main-content section').forEach(sec => {
      sec.style.display = 'none';
    });
    // 선택한 섹션 보이기
    document.getElementById(sectionId).style.display = 'block';

    // 사이드 메뉴 활성화 처리
    document.querySelectorAll('.side-nav a').forEach(link => {
      link.classList.remove('active');
    });
    if (event && event.target) {
      event.target.classList.add('active');
    }

    // '회원 정보 수정' 섹션인 경우 AJAX로 업데이트 폼 로드
    if (sectionId === 'update')
    {fetch("{% url 'update_profile' %}")
        .then(response => response.text())
        .then(html => {
          document.getElementById('updateProfileContainer').innerHTML = html;
        })
        .catch(error => {
          console.error('업데이트 폼 로드 중 에러 발생:', error);
        });
    }
  }
</script>
</body>
</html>
